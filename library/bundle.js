!function(e){function t(e){var t=document.getElementsByTagName("head")[0],l=document.createElement("script");l.type="text/javascript",l.charset="utf-8",l.src=d.p+""+e+"."+E+".hot-update.js",t.appendChild(l)}function l(e){if("undefined"==typeof XMLHttpRequest)return e(new Error("No browser support"));try{var t=new XMLHttpRequest,l=d.p+""+E+".hot-update.json";t.open("GET",l,!0),t.timeout=1e4,t.send(null)}catch(t){return e(t)}t.onreadystatechange=function(){if(4===t.readyState)if(0===t.status)e(new Error("Manifest request to "+l+" timed out."));else if(404===t.status)e();else if(200!==t.status&&304!==t.status)e(new Error("Manifest request to "+l+" failed."));else{try{var n=JSON.parse(t.responseText)}catch(t){return void e(t)}e(null,n)}}}function n(e){function t(e,t){"ready"===w&&r("prepare"),x++,d.e(e,function(){function l(){x--,"prepare"===w&&(O[e]||i(e),0===x&&0===C&&s())}try{t.call(null,n)}finally{l()}})}var l=B[e];if(!l)return d;var n=function(t){return l.hot.active?B[t]?(B[t].parents.indexOf(e)<0&&B[t].parents.push(e),l.children.indexOf(t)<0&&l.children.push(t)):k=[e]:(console.warn("[HMR] unexpected require("+t+") from disposed module "+e),k=[]),d(t)};for(var a in d)Object.prototype.hasOwnProperty.call(d,a)&&(h?Object.defineProperty(n,a,function(e){return{configurable:!0,enumerable:!0,get:function(){return d[e]},set:function(t){d[e]=t}}}(a)):n[a]=d[a]);return h?Object.defineProperty(n,"e",{enumerable:!0,value:t}):n.e=t,n}function a(e){var t={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],active:!0,accept:function(e,l){if("undefined"==typeof e)t._selfAccepted=!0;else if("function"==typeof e)t._selfAccepted=e;else if("object"==typeof e)for(var n=0;n<e.length;n++)t._acceptedDependencies[e[n]]=l;else t._acceptedDependencies[e]=l},decline:function(e){if("undefined"==typeof e)t._selfDeclined=!0;else if("number"==typeof e)t._declinedDependencies[e]=!0;else for(var l=0;l<e.length;l++)t._declinedDependencies[e[l]]=!0},dispose:function(e){t._disposeHandlers.push(e)},addDisposeHandler:function(e){t._disposeHandlers.push(e)},removeDisposeHandler:function(e){var l=t._disposeHandlers.indexOf(e);l>=0&&t._disposeHandlers.splice(l,1)},check:u,apply:f,status:function(e){return e?void _.push(e):w},addStatusHandler:function(e){_.push(e)},removeStatusHandler:function(e){var t=_.indexOf(e);t>=0&&_.splice(t,1)},data:g[e]};return t}function r(e){w=e;for(var t=0;t<_.length;t++)_[t].call(null,e)}function o(e){var t=+e+""===e;return t?+e:e}function u(e,t){if("idle"!==w)throw new Error("check() is only allowed in idle status");"function"==typeof e?(y=!1,t=e):(y=e,t=t||function(e){if(e)throw e}),r("check"),l(function(e,l){if(e)return t(e);if(!l)return r("idle"),void t(null,null);S={},j={},O={};for(var n=0;n<l.c.length;n++)j[l.c[n]]=!0;v=l.h,r("prepare"),m=t,b={};var a=0;i(a),"prepare"===w&&0===x&&0===C&&s()})}function c(e,t){if(j[e]&&S[e]){S[e]=!1;for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(b[l]=t[l]);0===--C&&0===x&&s()}}function i(e){j[e]?(S[e]=!0,C++,t(e)):O[e]=!0}function s(){r("ready");var e=m;if(m=null,e)if(y)f(y,e);else{var t=[];for(var l in b)Object.prototype.hasOwnProperty.call(b,l)&&t.push(o(l));e(null,t)}}function f(t,l){function n(e){for(var t=[e],l={},n=t.slice();n.length>0;){var r=n.pop(),e=B[r];if(e&&!e.hot._selfAccepted){if(e.hot._selfDeclined)return new Error("Aborted because of self decline: "+r);if(0===r)return;for(var o=0;o<e.parents.length;o++){var u=e.parents[o],c=B[u];if(c.hot._declinedDependencies[r])return new Error("Aborted because of declined dependency: "+r+" in "+u);t.indexOf(u)>=0||(c.hot._acceptedDependencies[r]?(l[u]||(l[u]=[]),a(l[u],[r])):(delete l[u],t.push(u),n.push(u)))}}}return[t,l]}function a(e,t){for(var l=0;l<t.length;l++){var n=t[l];e.indexOf(n)<0&&e.push(n)}}if("ready"!==w)throw new Error("apply() is only allowed in ready status");"function"==typeof t?(l=t,t={}):t&&"object"==typeof t?l=l||function(e){if(e)throw e}:(t={},l=l||function(e){if(e)throw e});var u={},c=[],i={};for(var s in b)if(Object.prototype.hasOwnProperty.call(b,s)){var f=o(s),p=n(f);if(!p){if(t.ignoreUnaccepted)continue;return r("abort"),l(new Error("Aborted because "+f+" is not accepted"))}if(p instanceof Error)return r("abort"),l(p);i[f]=b[f],a(c,p[0]);for(var f in p[1])Object.prototype.hasOwnProperty.call(p[1],f)&&(u[f]||(u[f]=[]),a(u[f],p[1][f]))}for(var h=[],m=0;m<c.length;m++){var f=c[m];B[f]&&B[f].hot._selfAccepted&&h.push({module:f,errorHandler:B[f].hot._selfAccepted})}r("dispose");for(var y=c.slice();y.length>0;){var f=y.pop(),_=B[f];if(_){for(var C={},x=_.hot._disposeHandlers,O=0;O<x.length;O++){var S=x[O];S(C)}g[f]=C,_.hot.active=!1,delete B[f];for(var O=0;O<_.children.length;O++){var j=B[_.children[O]];if(j){var I=j.parents.indexOf(f);I>=0&&j.parents.splice(I,1)}}}}for(var f in u)if(Object.prototype.hasOwnProperty.call(u,f))for(var _=B[f],T=u[f],O=0;O<T.length;O++){var P=T[O],I=_.children.indexOf(P);I>=0&&_.children.splice(I,1)}r("apply"),E=v;for(var f in i)Object.prototype.hasOwnProperty.call(i,f)&&(e[f]=i[f]);var N=null;for(var f in u)if(Object.prototype.hasOwnProperty.call(u,f)){for(var _=B[f],T=u[f],H=[],m=0;m<T.length;m++){var P=T[m],S=_.hot._acceptedDependencies[P];H.indexOf(S)>=0||H.push(S)}for(var m=0;m<H.length;m++){var S=H[m];try{S(u)}catch(e){N||(N=e)}}}for(var m=0;m<h.length;m++){var F=h[m],f=F.module;k=[f];try{d(f)}catch(e){if("function"==typeof F.errorHandler)try{F.errorHandler(e)}catch(e){N||(N=e)}else N||(N=e)}}return N?(r("fail"),l(N)):(r("idle"),void l(null,c))}function d(t){if(B[t])return B[t].exports;var l=B[t]={exports:{},id:t,loaded:!1,hot:a(t),parents:k,children:[]};return e[t].call(l.exports,l,l.exports,n(t)),l.loaded=!0,l.exports}var p=this.webpackHotUpdate;this.webpackHotUpdate=function(e,t){c(e,t),p&&p(e,t)};var h=!1;try{Object.defineProperty({},"x",{get:function(){}}),h=!0}catch(e){}var m,b,v,y=!0,E="24d23a757729e9f5fb18",g={},k=[],_=[],w="idle",C=0,x=0,O={},S={},j={},B={};return d.m=e,d.c=B,d.p="",d.h=function(){return E},n(0)(0)}([function(e,t,l){e.exports=l(1)},function(e,t,l){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=function(){function e(e,t){for(var l=0;l<t.length;l++){var n=t[l];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,l,n){return l&&e(t.prototype,l),n&&e(t,n),t}}(),c=l(2),i=n(c),s=l(4),f=n(s),d=l(5),p=l(6),h=n(p),m=l(7),b=l(8),v=n(b),y=l(17),E=n(y),g=l(21),k=n(g);l(24),l(26),l(28);var _=(0,h.default)({queryKey:!1}),w=function(e){function t(){return a(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),u(t,[{key:"handleHashIndex",value:function(e){var t=0==e?"#borrow":1==e?"#donate":"#list";window.location.hash=t}},{key:"render",value:function(){return i.default.createElement("div",{className:"main-body"},i.default.createElement(d.Router,{history:_},i.default.createElement(d.Route,{path:"/"},i.default.createElement(d.IndexRoute,{component:v.default}),i.default.createElement(d.Route,{path:"/borrow",component:v.default}),i.default.createElement(d.Route,{path:"/donate",component:E.default}),i.default.createElement(d.Route,{path:"/list",component:k.default}))),i.default.createElement(m.Tab,{type:"tabbar",className:"tabbar",onChange:this.handleHashIndex},i.default.createElement(m.TabBarItem,{icon:i.default.createElement("img",{src:"//gw.alicdn.com/tfs/TB1ZrRso2DH8KJjy1XcXXcpdXXa-81-81.png"}),label:"借书"}),i.default.createElement(m.TabBarItem,{icon:i.default.createElement("img",{src:"//gw.alicdn.com/tfs/TB1M8e.myqAXuNjy1XdXXaYcVXa-81-81.png"}),label:"捐书"}),i.default.createElement(m.TabBarItem,{icon:i.default.createElement("img",{src:"//gw.alicdn.com/tfs/TB1JQ9.myqAXuNjy1XdXXaYcVXa-81-81.png"}),label:"书目"})))}}]),t}(i.default.Component);f.default.render(i.default.createElement(w,null),document.getElementById("react-content"))},function(e,t,l){e.exports=l(3)(1)},function(e,t){e.exports=lib},function(e,t,l){e.exports=l(3)(37)},function(e,t,l){e.exports=l(3)(184)},function(e,t,l){e.exports=l(3)(194)},function(e,t,l){e.exports=l(3)(247)},function(e,t,l){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var l=0;l<t.length;l++){var n=t[l];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,l,n){return l&&e(t.prototype,l),n&&e(t,n),t}}(),c=l(2),i=n(c),s=l(4),f=(n(s),l(7));l(9);var d=l(13),p=l(16),h=function(e){function t(e){a(this,t);var l=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return l.state={dialog:!1,show:!1,text:"",timer:null,loading_show:!1,picker_show:!1,picker_value:"环境学院",picker_group:[{items:[{label:"健行学院"},{label:"化学工程学院"},{label:"海洋学院"},{label:"材料科学与工程学院"},{label:"机械工程学院"},{label:"信息工程学院"},{label:"计算机科学与技术学院（软件学院）"},{label:"经贸管理学院"},{label:"建筑工程学院"},{label:"生物工程学院"},{label:"环境学院"},{label:"教育科学与技术学院"},{label:"外国语学院"},{label:"药学院 、绿色制药协同创新中心"},{label:"理学院"},{label:"人文学院"},{label:"艺术学院"},{label:"法学院"},{label:"政治与公共管理学院"},{label:"国际学院"}]}],step:0,step1:{xiaoqu:"屏峰校区",name:"",xuehao:"",phone:""},step2:{type:"0",value:"",all:[],searched:[],checked:[]}},l}return o(t,e),u(t,[{key:"componentDidMount",value:function(){var e=this,t=e.state.step2;(0,d.getBookList)().then(function(l){for(var n=[],a=0;a<l.length;a++){var r=l[a].attributes;n.push({key:a,id:l[a].id,author:r.author||"",name:r.name||"",num:r.num||0,publish:r.publish||""})}t.all=n,e.setState({step2:t})})}},{key:"componentWillUnmount",value:function(){this.state.timer&&clearTimeout(this.state.timer)}},{key:"changeRadio",value:function(e){var t=this.state.step1;t.xiaoqu=e,this.setState({step1:t})}},{key:"handleInput",value:function(e,t){var l=this.state.step1;l[t]=e.target.value,this.setState({step1:l})}},{key:"handleStep",value:function(e){var t=this;if(0==e)this.setState({step:e});else if(1==e){var l=this.state.step1,n=/^[1][3-9][0-9]{9}$/,a=new RegExp(n),r=!1;""===l.name.trim()?r=!0:l.xuehao.length<6||l.xuehao.length>12?r=!0:a.test(l.phone)||(r=!0),r?(this.setState({show:!0,text:"请检查表单信息是否填写正确"}),this.state.timer=setTimeout(function(){t.setState({show:!1})},2e3)):this.setState({step:e})}else if(2==e){var o=this.state.step2,u=o.checked,c=o.all,i=this.state,s=i.step1,f=i.picker_value,h=this;h.setState({loading_show:!0,dialog:!1});for(var m=0;m<u.length;m++)(0,d.borrowBook)(u[m]);for(var b="",v=0;v<u.length;v++)for(var y=u[v],E=0;E<c.length;E++)c[E].id==y&&(b+=c[E].name+"、");s.books=b,s.xueyuan=f,(0,p.addBorrow)(s).save().then(function(t){h.setState({loading_show:!1,step:e})})}}},{key:"changeCheckBox",value:function(e,t){var l=this,n=this.state.step2,a=n.checked,r=n.all,o=a.indexOf(t);return 0==r[parseInt(e)].num?(this.setState({show:!0,text:"该书库存少于1本，暂不可借"}),void(this.state.timer=setTimeout(function(){l.setState({show:!1})},2e3))):a.length>=5&&o==-1?(this.setState({show:!0,text:"你最多可以选5本书"}),void(this.state.timer=setTimeout(function(){l.setState({show:!1})},2e3))):(o==-1?a.push(t):a.splice(o,1),n.checked=a,void this.setState({checked:a}))}},{key:"changeSelect",value:function(e){var t=this.state.step2,l=e.target.value;t.type=l,this.setState({step2:t})}},{key:"changeSearch",value:function(e){var t=this.state.step2,l=e.target.value,n=""===l?[]:t.searched;t.value=l,t.searched=n,this.setState({step2:t})}},{key:"handleSearch",value:function(){for(var e=this.state.step2,t=e.type,l=e.value,n=e.all,a=["name","author","publish"],r=a[parseInt(t)],o=[],u=0;u<n.length;u++)n[u][r].indexOf(l)!=-1&&o.push(n[u]);e.searched=o,this.setState({step2:e})}},{key:"handleDialog",value:function(){var e=this,t=this.state,l=t.step2,n=t.dialog;n||0!=l.checked.length?this.setState({dialog:!n}):(this.setState({show:!0,text:"请先选择要借阅的书籍"}),this.state.timer=setTimeout(function(){e.setState({show:!1})},2e3))}},{key:"render",value:function(){var e=this,t=this.state,l=t.step1,n=t.step2,a=n.searched,r=n.all,o=n.checked,u=a.length>0?a:r;return i.default.createElement("div",{className:"scroll-body"},i.default.createElement(f.Toast,{icon:"loading",show:this.state.loading_show},"提交中..."),i.default.createElement(f.Toptips,{type:"warn",show:this.state.show},this.state.text),0===this.state.step&&i.default.createElement("div",null,i.default.createElement(f.CellsTitle,{className:"cell-title"},"第一步：信息填写"),i.default.createElement(f.Form,{radio:!0},i.default.createElement(f.CellsTitle,null,"校区信息"),i.default.createElement(f.FormCell,{radio:!0,onClick:function(){return e.changeRadio("屏峰校区")}},i.default.createElement(f.CellBody,null,"屏峰校区"),i.default.createElement(f.CellFooter,null,i.default.createElement(f.Radio,{checked:"屏峰校区"==l.xiaoqu}))),i.default.createElement(f.FormCell,{radio:!0,onClick:function(){return e.changeRadio("朝晖校区")}},i.default.createElement(f.CellBody,null,"朝晖校区"),i.default.createElement(f.CellFooter,null,i.default.createElement(f.Radio,{checked:"朝晖校区"==l.xiaoqu})))),i.default.createElement(f.Form,null,i.default.createElement(f.CellsTitle,null,"个人信息"),i.default.createElement(f.FormCell,null,i.default.createElement(f.CellHeader,null,i.default.createElement(f.Label,null,"姓名")),i.default.createElement(f.CellBody,null,i.default.createElement(f.Input,{type:"text",placeholder:"你的姓名",value:l.name,onChange:function(t){return e.handleInput(t,"name")}}))),i.default.createElement(f.FormCell,null,i.default.createElement(f.CellHeader,null,i.default.createElement(f.Label,null,"学院")),i.default.createElement(f.CellBody,null,i.default.createElement(f.Input,{type:"text",onClick:function(t){t.preventDefault(),e.setState({picker_show:!0})},placeholder:"选择你所在的学院",value:this.state.picker_value,readOnly:!0}))),i.default.createElement(f.Picker,{lang:{leftBtn:"取消",rightBtn:"确定"},onChange:function(t){var l="";t.forEach(function(t,n){l=e.state.picker_group[n].items[t].label}),e.setState({picker_value:l,picker_show:!1})},groups:this.state.picker_group,show:this.state.picker_show,onCancel:function(t){return e.setState({picker_show:!1})}}),i.default.createElement(f.FormCell,null,i.default.createElement(f.CellHeader,null,i.default.createElement(f.Label,null,"学号")),i.default.createElement(f.CellBody,null,i.default.createElement(f.Input,{type:"number",placeholder:"你的学号",value:l.xuehao,onChange:function(t){return e.handleInput(t,"xuehao")}}))),i.default.createElement(f.FormCell,null,i.default.createElement(f.CellHeader,null,i.default.createElement(f.Label,null,"联系方式")),i.default.createElement(f.CellBody,null,i.default.createElement(f.Input,{type:"number",placeholder:"手机长号",value:l.phone,onChange:function(t){return e.handleInput(t,"phone")}})))),i.default.createElement(f.CellsTips,null,"请仔细填写以上信息"),i.default.createElement(f.Button,{className:"large-btn",onClick:function(){return e.handleStep(1)}},"下一步")),1===this.state.step&&i.default.createElement("div",null,i.default.createElement(f.Dialog,{title:"注意事项",buttons:[{type:"default",label:"取消",onClick:this.handleDialog.bind(this)},{type:"primary",label:"同意",onClick:function(){return e.handleStep(2)}}],show:this.state.dialog},"请爱护书籍，若有遗失或损坏情况严重者，将不再给予借阅"),i.default.createElement(f.CellsTitle,{className:"cell-title",onClick:function(){return e.handleStep(0)}},"<< 返回上一步"),i.default.createElement(f.Form,null,i.default.createElement(f.FormCell,{select:!0,selectPos:"before",className:"select-form"},i.default.createElement(f.CellHeader,null,i.default.createElement(f.Select,{className:"select-list",onChange:this.changeSelect.bind(this)},i.default.createElement("option",{value:"0"},"书名"),i.default.createElement("option",{value:"1"},"作者"),i.default.createElement("option",{value:"2"},"出版社"))),i.default.createElement(f.CellBody,null,i.default.createElement(f.Input,{type:"text",onChange:this.changeSearch.bind(this)})),i.default.createElement(f.CellFooter,null,i.default.createElement(f.Button,{type:"vcode",className:"search-btn",onClick:this.handleSearch.bind(this)},"搜索")))),i.default.createElement(f.CellsTitle,null,i.default.createElement("div",{className:"remain-num"},"剩余可选",5-o.length,"本"),i.default.createElement(f.Button,{size:"small",className:"right-mini-btn",type:o.length>0?"primary":"default",onClick:function(){return e.handleDialog()}},"选好了")),i.default.createElement(f.Form,{checkbox:!0,className:"margin-form"},u.map(function(t,l){return i.default.createElement(f.FormCell,{key:"form"+t.key,checkbox:!0,className:"rich-checkbox"},i.default.createElement(f.CellHeader,null,i.default.createElement(f.Checkbox,{checked:o.indexOf(t.id)!=-1,onClick:function(){return e.changeCheckBox(t.key,t.id)}})),i.default.createElement(f.CellBody,null,i.default.createElement("div",{className:"book-name"},t.name),i.default.createElement("div",{className:"book-info"},t.author,"#",t.publish)),i.default.createElement(f.CellFooter,null,i.default.createElement("div",{className:"book-num"},"可借：",t.num)))}))),2===this.state.step&&i.default.createElement("div",null,i.default.createElement(f.Msg,{type:"success",title:"借阅成功",description:i.default.createElement("div",null,i.default.createElement("p",null,"取书时间：每周五中午12点到1点"),i.default.createElement("p",null,"取书地点：","屏峰校区"==l.xiaoqu?"屏峰-西12架空层团学办公室":"朝晖-老研楼103"),i.default.createElement("p",null,"还书时间：每学期第一周周六，届时还书请到","屏峰校区"==l.xiaoqu?"屏峰-支干路摊位":"朝晖-综合楼前摊位"),i.default.createElement("p",{className:"important-p"},"注意：若未在规定时间内还书超过2次，以后就不给予借阅")),buttons:[{type:"primary",label:"确定",onClick:function(){return e.handleStep(0)}}]})))}}]),t}(i.default.Component);t.default=h},function(e,t){},,,,function(e,t,l){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(){var e=new u.default.Query("Book");return e.limit(500).find()}function r(e){var t=u.default.Object.createWithoutData("Book",e);t.fetch().then(function(){var e=t.get("num");t.set("num",e-1),t.save()},function(e){})}Object.defineProperty(t,"__esModule",{value:!0}),t.getBookList=a,t.borrowBook=r;var o=l(14),u=n(o),c=l(15),i=n(c);u.default.init({appId:i.default.appId,appKey:i.default.appKey})},function(e,t,l){e.exports=l(3)(466)},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={appId:"9IGHxthDkB0WBEW5CSmljqXH-gzGzoHsz",appKey:"INwaT9iIBrfeY01FiS2qkrvv"}},function(e,t,l){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=o.default.Object.extend("Borrow"),l=new t;for(var n in e)l.set(n,e[n]);return l}Object.defineProperty(t,"__esModule",{value:!0}),t.addBorrow=a;var r=l(14),o=n(r),u=l(15),c=n(u);o.default.init({appId:c.default.appId,appKey:c.default.appKey})},function(e,t,l){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var l=0;l<t.length;l++){var n=t[l];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,l,n){return l&&e(t.prototype,l),n&&e(t,n),t}}(),c=l(2),i=n(c),s=l(4),f=(n(s),l(7));l(18);var d=l(20),p=function(e){function t(e){a(this,t);var l=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return l.state={success:!1,show:!1,text:"",timer:null,loading_show:!1,picker_show:!1,picker_value:"环境学院",picker_group:[{items:[{label:"健行学院"},{label:"化学工程学院"},{label:"海洋学院"},{label:"材料科学与工程学院"},{label:"机械工程学院"},{label:"信息工程学院"},{label:"计算机科学与技术学院（软件学院）"},{label:"经贸管理学院"},{label:"建筑工程学院"},{label:"生物工程学院"},{label:"环境学院"},{label:"教育科学与技术学院"},{label:"外国语学院"},{label:"药学院 、绿色制药协同创新中心"},{label:"理学院"},{label:"人文学院"},{label:"艺术学院"},{label:"法学院"},{label:"政治与公共管理学院"},{label:"国际学院"}]}],form:{name:"",xueyuan:"",qinshi:"",phone:"",num:"0",books:""}},l}return o(t,e),u(t,[{key:"componentWillUnmount",value:function(){this.state.timer&&clearTimeout(this.state.timer)}},{key:"handleInput",value:function(e,t){var l=this.state.form;l[t]=e.target.value,this.setState({form:l})}},{key:"backForward",value:function(){this.setState({success:!1,form:{name:"",qinshi:"",phone:"",num:"0",books:""}})}},{key:"handleSubmit",value:function(){var e=this,t=this.state,l=t.form,n=t.picker_value,a=this,r=/^[1][3-9][0-9]{9}$/,o=new RegExp(r),u=!1;""===l.name.trim()?u=!0:""===l.qinshi.trim()?u=!0:o.test(l.phone)?parseInt(l.num)<=0&&(u=!0):u=!0,u?(this.setState({show:!0,text:"请检查表单信息是否填写正确"}),this.state.timer=setTimeout(function(){e.setState({show:!1})},2e3)):(a.setState({loading_show:!0}),l.xueyuan=n,(0,d.addDonate)(l).save().then(function(e){a.setState({success:!0,loading_show:!1})}))}},{key:"render",value:function(){var e=this,t=this.state.form;return i.default.createElement("div",{className:"scroll-body"},!this.state.success&&i.default.createElement("div",null,i.default.createElement(f.Toast,{icon:"loading",show:this.state.loading_show},"提交中..."),i.default.createElement(f.Toptips,{type:"warn",show:this.state.show},this.state.text),i.default.createElement(f.CellsTitle,{className:"cell-title"},"信息填写"),i.default.createElement(f.Form,null,i.default.createElement(f.FormCell,null,i.default.createElement(f.CellHeader,null,i.default.createElement(f.Label,null,"姓名")),i.default.createElement(f.CellBody,null,i.default.createElement(f.Input,{type:"text",placeholder:"你的姓名",value:t.name,onChange:function(t){return e.handleInput(t,"name")}}))),i.default.createElement(f.FormCell,null,i.default.createElement(f.CellHeader,null,i.default.createElement(f.Label,null,"学院")),i.default.createElement(f.CellBody,null,i.default.createElement(f.Input,{type:"text",onClick:function(t){t.preventDefault(),e.setState({picker_show:!0})},placeholder:"选择你所在的学院",value:this.state.picker_value,readOnly:!0}))),i.default.createElement(f.Picker,{lang:{leftBtn:"取消",rightBtn:"确定"},onChange:function(t){var l="";t.forEach(function(t,n){l=e.state.picker_group[n].items[t].label}),e.setState({picker_value:l,picker_show:!1})},groups:this.state.picker_group,show:this.state.picker_show,onCancel:function(t){return e.setState({picker_show:!1})}}),i.default.createElement(f.FormCell,null,i.default.createElement(f.CellHeader,null,i.default.createElement(f.Label,null,"寝室")),i.default.createElement(f.CellBody,null,i.default.createElement(f.Input,{type:"text",placeholder:"你的寝室，需注明楼",value:t.qinshi,onChange:function(t){return e.handleInput(t,"qinshi")}}))),i.default.createElement(f.FormCell,null,i.default.createElement(f.CellHeader,null,i.default.createElement(f.Label,null,"联系方式")),i.default.createElement(f.CellBody,null,i.default.createElement(f.Input,{type:"number",placeholder:"手机长号",value:t.phone,onChange:function(t){return e.handleInput(t,"phone")}}))),i.default.createElement(f.FormCell,null,i.default.createElement(f.CellHeader,null,i.default.createElement(f.Label,null,"捐书数量")),i.default.createElement(f.CellBody,null,i.default.createElement(f.Input,{type:"number",placeholder:"捐书数量",value:t.num,onChange:function(t){return e.handleInput(t,"num")}}))),i.default.createElement(f.Cell,{link:!0},i.default.createElement(f.CellBody,null,"提示：捐书数量超过5本会有专人上门收书")),t.num>=5&&i.default.createElement(f.FormCell,null,i.default.createElement(f.CellBody,null,i.default.createElement(f.TextArea,{placeholder:"请备注书名",rows:"3",maxlength:"200",value:t.books,onChange:function(t){return e.handleInput(t,"books")}})))),i.default.createElement(f.CellsTips,null,"请仔细填写以上信息"),i.default.createElement(f.Button,{className:"large-btn",onClick:function(){return e.handleSubmit()}},"确认提交")),this.state.success&&i.default.createElement("div",null,i.default.createElement(f.Msg,{type:"success",title:"提交成功",description:parseInt(t.num)>=5?"我们会安排工作人员上门收书，收书时间：每周四中午12点到1点":"收书时间地点：每周五中午12点到1点在朝晖老研楼103，屏峰西12架空层团学办公室",buttons:[{type:"primary",label:"返回",onClick:function(){return e.backForward()}}]})))}}]),t}(i.default.Component);t.default=p},function(e,t){},,function(e,t,l){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=o.default.Object.extend("Donate"),l=new t;for(var n in e)l.set(n,e[n]);return l}Object.defineProperty(t,"__esModule",{value:!0}),t.addDonate=a;var r=l(14),o=n(r),u=l(15),c=n(u);o.default.init({appId:c.default.appId,appKey:c.default.appKey})},function(e,t,l){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var l=0;l<t.length;l++){var n=t[l];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,l,n){return l&&e(t.prototype,l),n&&e(t,n),t}}(),c=l(2),i=n(c),s=l(4),f=(n(s),l(7));l(22);var d=l(13),p=function(e){function t(e){a(this,t);var l=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return l.state={loading_show:!0,picker_show:!1,picker_value:"全部",picker_group:[{items:[{label:"全部"},{label:"大一（屏峰）"},{label:"大一（朝晖）"},{label:"大二（屏峰）"},{label:"大二（朝晖）"},{label:"大三（屏峰）"},{label:"大三（朝晖）"},{label:"大四（屏峰）"},{label:"大四（朝晖）"},{label:"考研（屏峰）"},{label:"考研（朝晖）"},{label:"考公（屏峰）"},{label:"考公（朝晖）"},{label:"考级（屏峰）"},{label:"考级（朝晖）"},{label:"复习资料（屏峰）"},{label:"复习资料（朝晖）"},{label:"其他学院（屏峰）"},{label:"其他学院（朝晖）"}]}],type:"0",value:"",all:[],searched:[],picked:[],count:0},l}return o(t,e),u(t,[{key:"hide",value:function(){this.setState({picker_show:!1})}},{key:"componentDidMount",value:function(){var e=this;(0,d.getBookList)().then(function(t){for(var l=[],n=0,a=0;a<t.length;a++){var r=t[a].attributes;l.push({key:a,id:t[a].id,author:r.author||"",name:r.name||"",num:r.num||0,publish:r.publish||"",type:r.type}),n+=r.num}e.setState({all:l,count:n,loading_show:!1})})}},{key:"handleSelect",value:function(e){var t=e.target.value;this.setState({type:t})}},{key:"handleChange",value:function(e){var t=this.state,l=t.searched,n=t.picker_value,a=e.target.value;l=""===a?[]:l,n=""===a?"全部":n,this.setState({value:a,searched:l,picker_value:n})}},{key:"handleSearch",value:function(){for(var e=this.state,t=e.type,l=e.value,n=e.all,a=["name","author","publish"],r=a[parseInt(t)],o=[],u=0;u<n.length;u++)n[u][r].indexOf(l)!=-1&&o.push(n[u]);this.setState({searched:o,picker_value:"全部"})}},{key:"handlePicker",value:function(e){var t=this,l=this.state,n=l.all,a=l.searched,r="";if(e.forEach(function(e,l){r=t.state.picker_group[l].items[e].label}),"全部"===r)return void this.setState({picker_value:r,picker_show:!1,picked:[]});for(var o=a.length>0?a:n,u=[],c=0;c<o.length;c++)o[c].type===r&&u.push(o[c]);u.length>0?this.setState({picked:u,picker_value:r,picker_show:!1}):(this.setState({picker_show:!1}),alert("找不到该分类"))}},{key:"render",value:function(){var e=this,t=this.state,l=t.searched,n=t.all,a=t.picked,r=t.picker_value,o=l.length>0?l:n;return o="全部"==r?o:a,i.default.createElement("div",{className:"scroll-body"},i.default.createElement("div",null,i.default.createElement(f.Toast,{icon:"loading",show:this.state.loading_show},"加载中..."),i.default.createElement(f.CellsTitle,{className:"cell-title"},"所有书目"),i.default.createElement(f.Form,null,i.default.createElement(f.FormCell,{select:!0,selectPos:"before",className:"select-form"},i.default.createElement(f.CellHeader,null,i.default.createElement(f.Select,{className:"select-list",onChange:this.handleSelect.bind(this)},i.default.createElement("option",{value:"0"},"书名"),i.default.createElement("option",{value:"1"},"作者"),i.default.createElement("option",{value:"2"},"出版社"))),i.default.createElement(f.CellBody,null,i.default.createElement(f.Input,{type:"text",onChange:this.handleChange.bind(this)})),i.default.createElement(f.CellFooter,null,i.default.createElement(f.Button,{type:"vcode",className:"search-btn",onClick:this.handleSearch.bind(this)},"搜索")))),i.default.createElement(f.Form,{style:{marginTop:0}},i.default.createElement(f.FormCell,null,i.default.createElement(f.CellHeader,null,i.default.createElement(f.Label,null,"图书分类")),i.default.createElement(f.CellBody,null,i.default.createElement(f.Input,{type:"text",onClick:function(t){t.preventDefault(),e.setState({picker_show:!0})},placeholder:"请选择一个分类",value:this.state.picker_value,readOnly:!0})))),i.default.createElement(f.Picker,{lang:{leftBtn:"取消",rightBtn:"确定"},onChange:function(t){return e.handlePicker(t)},groups:this.state.picker_group,show:this.state.picker_show,onCancel:function(t){return e.setState({picker_show:!1})}}),i.default.createElement("div",null,i.default.createElement(f.CellsTitle,{className:"cell-title"},"绿色书库当前共有",this.state.count,"本书"),i.default.createElement(f.Cells,{className:"full-cell"},o.map(function(e,t){return i.default.createElement(f.Cell,{className:"rich-cell",key:"cell"+e.id},i.default.createElement(f.CellBody,null,i.default.createElement("div",{className:"book-name"},e.name),i.default.createElement("div",{className:"book-info"},e.author,"#",e.publish)),i.default.createElement(f.CellFooter,null,i.default.createElement("div",{className:"book-num"},i.default.createElement(f.Badge,{preset:"body",className:["大一（屏峰）","大一（朝晖）","大二（屏峰）","大二（朝晖）","大三（屏峰）","大三（朝晖）","大四（屏峰）","大四（朝晖）"].indexOf(e.type)!=-1?"blue-badge":["考研（屏峰）","考公（屏峰）","考级（屏峰）","考研（朝晖）","考公（朝晖）","考级（朝晖）"].indexOf(e.type)!=-1?"red-badge":["复习资料（屏峰）","复习资料（朝晖）"].indexOf(e.type)!=-1?"green-badge":"grey-badge"},e.type))))})))))}}]),t}(i.default.Component);t.default=p},function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){}]);